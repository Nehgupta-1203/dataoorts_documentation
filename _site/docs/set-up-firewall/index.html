<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <link rel="stylesheet" href="/dataoorts_documentation/assets/css/just-the-docs-default.css"> <link rel="stylesheet" href="/dataoorts_documentation/assets/css/just-the-docs-head-nav.css" id="jtd-head-nav-stylesheet"> <style id="jtd-nav-activation"> .site-nav > ul.nav-list:first-child > li > a, .site-nav > ul.nav-list:first-child > li > ul > li:not(:nth-child(4)) > a, .site-nav > ul.nav-list:first-child > li > ul > li > ul > li a { background-image: none; } .site-nav > ul.nav-list:not(:first-child) a, .site-nav li.external a { background-image: none; } .site-nav > ul.nav-list:first-child > li:nth-child(2) > ul > li:nth-child(4) > a { font-weight: 600; text-decoration: none; }.site-nav > ul.nav-list:first-child > li:nth-child(2) > button svg, .site-nav > ul.nav-list:first-child > li:nth-child(2) > ul > li:nth-child(4) > button svg { transform: rotate(-90deg); }.site-nav > ul.nav-list:first-child > li.nav-list-item:nth-child(2) > ul.nav-list, .site-nav > ul.nav-list:first-child > li.nav-list-item:nth-child(2) > ul.nav-list > li.nav-list-item:nth-child(4) > ul.nav-list { display: block; } </style> <script src="/dataoorts_documentation/assets/js/vendor/lunr.min.js"></script> <script src="/dataoorts_documentation/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.8.0 --> <title>Configure Firewalls and Security Groups | Dataoorts Documentation</title> <meta name="generator" content="Jekyll v3.10.0" /> <meta property="og:title" content="Configure Firewalls and Security Groups" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="Write an awesome description for your new site here. You can edit this line in _config.yml. It will appear in your document head meta (for Google search results) and in your feed.xml site description." /> <meta property="og:description" content="Write an awesome description for your new site here. You can edit this line in _config.yml. It will appear in your document head meta (for Google search results) and in your feed.xml site description." /> <link rel="canonical" href="http://localhost:4000/dataoorts_documentation/docs/set-up-firewall/" /> <meta property="og:url" content="http://localhost:4000/dataoorts_documentation/docs/set-up-firewall/" /> <meta property="og:site_name" content="Dataoorts Documentation" /> <meta property="og:type" content="website" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="Configure Firewalls and Security Groups" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"WebPage","description":"Write an awesome description for your new site here. You can edit this line in _config.yml. It will appear in your document head meta (for Google search results) and in your feed.xml site description.","headline":"Configure Firewalls and Security Groups","url":"http://localhost:4000/dataoorts_documentation/docs/set-up-firewall/"}</script> <!-- End Jekyll SEO tag --> </head> <body> <a class="skip-to-main" href="#main-content">Skip to main content</a> <svg xmlns="http://www.w3.org/2000/svg" class="d-none"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <!-- Feather. MIT License: https://github.com/feathericons/feather/blob/master/LICENSE --> <symbol id="svg-external-link" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-external-link"> <title id="svg-external-link-title">(external link)</title> <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <!-- Bootstrap Icons. MIT License: https://github.com/twbs/icons/blob/main/LICENSE.md --> <symbol id="svg-copy" viewBox="0 0 16 16"> <title>Copy</title> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16"> <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/> <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"/> </svg> </symbol> <symbol id="svg-copied" viewBox="0 0 16 16"> <title>Copied</title> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard-check-fill" viewBox="0 0 16 16"> <path d="M6.5 0A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3Zm3 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3Z"/> <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1A2.5 2.5 0 0 1 9.5 5h-3A2.5 2.5 0 0 1 4 2.5v-1Zm6.854 7.354-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 0 1 .708-.708L7.5 10.793l2.646-2.647a.5.5 0 0 1 .708.708Z"/> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header" role="banner"> <a href="/dataoorts_documentation/" class="site-title lh-tight"> Dataoorts Documentation </a> <button id="menu-button" class="site-button btn-reset" aria-label="Toggle menu" aria-pressed="false"> <svg viewBox="0 0 24 24" class="icon" aria-hidden="true"><use xlink:href="#svg-menu"></use></svg> </button> </div> <nav aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in GC2 Instance Documentation category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/dataoorts_documentation/docs/development-cloud/" class="nav-list-link">GC2 Instance Documentation</a><ul class="nav-list"><li class="nav-list-item"><a href="/dataoorts_documentation/docs/gc2/" class="nav-list-link">Get Started With GC2 GPU Instance</a></li><li class="nav-list-item"><a href="/dataoorts_documentation/docs/gc2-instance-features/" class="nav-list-link">GC2 Instance Features</a></li><li class="nav-list-item"><a href="/dataoorts_documentation/docs/ssh-gc2-instances/" class="nav-list-link">SSH GC2 Instances</a></li><li class="nav-list-item"><a href="/dataoorts_documentation/docs/connect-gc2-locally/" class="nav-list-link">Connect GC2 Locally</a></li><li class="nav-list-item"><a href="/dataoorts_documentation/docs/gc2-instance-extent/" class="nav-list-link">GC2 Instance Extent</a></li><li class="nav-list-item"><a href="/dataoorts_documentation/docs/faqs-gc2-instance/" class="nav-list-link">FAQs: GC2 Instance</a></li><li class="nav-list-item"><a href="/dataoorts_documentation/docs/access-applications/" class="nav-list-link">Access Applications -- Tunnel</a></li><li class="nav-list-item"><a href="/dataoorts_documentation/docs/gc2-docker/" class="nav-list-link">GC2: Docker</a></li><li class="nav-list-item"><a href="/dataoorts_documentation/docs/gc2-kubernetes/" class="nav-list-link">GC2: Kubernetes</a></li><li class="nav-list-item"><a href="/dataoorts_documentation/docs/kind-cluster/" class="nav-list-link">KinD Cluster</a></li><li class="nav-list-item"><a href="/dataoorts_documentation/docs/minikube/" class="nav-list-link">Minikube Cluster</a></li><li class="nav-list-item"><a href="/dataoorts_documentation/docs/gc2-support/" class="nav-list-link">GC2: Support</a></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in X-Series Instance Documentation category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/dataoorts_documentation/docs/x-series-instance-documentation/" class="nav-list-link">X-Series Instance Documentation</a><ul class="nav-list"><li class="nav-list-item"><a href="/dataoorts_documentation/docs/get-started-x-series-gpu-instances/" class="nav-list-link">Get Started With X-Series GPU Instances</a></li><li class="nav-list-item"><a href="/dataoorts_documentation/docs/x-series-instance-faqs/" class="nav-list-link">FAQs: X-Series Instance</a></li><li class="nav-list-item"><a href="/dataoorts_documentation/docs/ssh-fortify/" class="nav-list-link">SSH Access Fortify</a></li><li class="nav-list-item"><a href="/dataoorts_documentation/docs/set-up-firewall/" class="nav-list-link">Configure Firewalls and Security Groups</a></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Serverless Cloud API - Dataoorts AI category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/dataoorts_documentation/docs/dataoorts-ai/" class="nav-list-link">Serverless Cloud API - Dataoorts AI</a><ul class="nav-list"><li class="nav-list-item"><a href="/dataoorts_documentation/docs/get-started/" class="nav-list-link">Get Started</a></li><li class="nav-list-item"><a href="/dataoorts_documentation/docs/ai-models-catalog" class="nav-list-link">AI Models Catalog</a></li><li class="nav-list-item"><a href="/dataoorts_documentation/docs/text-gen" class="nav-list-link">Text Generation</a></li><li class="nav-list-item"><a href="/dataoorts_documentation/docs/text-to-image-generation" class="nav-list-link">Image Generation</a></li></ul></li><li class="nav-list-item"><a href="/dataoorts_documentation/docs/cloud-api/" class="nav-list-link">Cloud Instance API</a></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in AI Powered Email Verification category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/dataoorts_documentation/docs/ai-emails-verification/" class="nav-list-link">AI Powered Email Verification</a><ul class="nav-list"><li class="nav-list-item"><a href="/dataoorts_documentation/docs/verify-emails-instantly-and-extract-key-data-powered-by-ai" class="nav-list-link">Verify Emails Instantly and Extract Key Data—Powered by AI</a></li><li class="nav-list-item"><a href="/dataoorts_documentation/docs/potential-usecases/" class="nav-list-link">Potential Use Cases</a></li><li class="nav-list-item"><a href="/dataoorts_documentation/docs/register-get-started/" class="nav-list-link">Register and Get Started</a></li><li class="nav-list-item"><a href="/dataoorts_documentation/docs/single-email-verification/" class="nav-list-link">Single email verification</a></li><li class="nav-list-item"><a href="/dataoorts_documentation/docs/bulk-email-verification/" class="nav-list-link">Bulk Email Verification</a></li><li class="nav-list-item"><a href="/dataoorts_documentation/docs/api-email-verification/" class="nav-list-link">API For Email Verification</a></li><li class="nav-list-item"><a href="/dataoorts_documentation/docs/faqs/" class="nav-list-link">FAQs</a></li></ul></li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/just-the-docs/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search" role="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search Dataoorts Documentation" aria-label="Search Dataoorts Documentation" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> </div> <div class="main-content-wrap"> <nav aria-label="Breadcrumb" class="breadcrumb-nav"> <ol class="breadcrumb-nav-list"> <li class="breadcrumb-nav-list-item"><a href="/dataoorts_documentation/docs/x-series-instance-documentation/">X-Series Instance Documentation</a></li> <li class="breadcrumb-nav-list-item"><span>Configure Firewalls and Security Groups</span></li> </ol> </nav> <div id="main-content" class="main-content"> <main> <h2 id="securing-cloud-gpu-vm-allowing-specific-ips-and-ports-with-ufw--iptables"> <a href="#securing-cloud-gpu-vm-allowing-specific-ips-and-ports-with-ufw--iptables" class="anchor-heading" aria-labelledby="securing-cloud-gpu-vm-allowing-specific-ips-and-ports-with-ufw--iptables"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Securing Cloud GPU VM: Allowing Specific IPs and Ports with UFW &amp; iptables </h2> <p>This guide will walk you through securing your Cloud Virtual Machine (VM) by configuring its firewall to accept incoming traffic only from a defined set of IP addresses and on specific ports. This drastically improves your VM’s security by blocking unauthorized access attempts. We will be using UFW (Uncomplicated Firewall), a user-friendly front-end for iptables, to manage these firewall rules.</p> <h3 id="prerequisites"> <a href="#prerequisites" class="anchor-heading" aria-labelledby="prerequisites"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Prerequisites </h3> <ul> <li>You have an Linux Cloud VM running and are able to access it via SSH.</li> <li>You have sudo privileges on the VM.</li> <li>You know the specific IP addresses that need to access your VM.</li> <li>You know the specific ports that need to be open for necessary services.</li> </ul> <h3 id="step-1-install-ufw-uncomplicated-firewall"> <a href="#step-1-install-ufw-uncomplicated-firewall" class="anchor-heading" aria-labelledby="step-1-install-ufw-uncomplicated-firewall"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Step 1: Install UFW (Uncomplicated Firewall) </h3> <p>If UFW is not already installed on your Ubuntu VM, you can install it using the following commands:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>apt update
<span class="nb">sudo </span>apt <span class="nb">install </span>ufw
</code></pre></div></div> <h3 id="step-2-set-default-firewall-policies"> <a href="#step-2-set-default-firewall-policies" class="anchor-heading" aria-labelledby="step-2-set-default-firewall-policies"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Step 2: Set Default Firewall Policies </h3> <p>UFW’s strength lies in its default deny policy. We will set the default behavior to deny all incoming connections and allow all outgoing connections. This is a fundamental security principle: only explicitly allowed traffic should be permitted.</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>ufw default deny incoming
<span class="nb">sudo </span>ufw default allow outgoing
</code></pre></div></div> <ul> <li><strong>sudo ufw default deny incoming</strong>: This command sets the default policy for all incoming connections to deny. This means unless a rule explicitly allows an incoming connection, it will be blocked.</li> <li><strong>sudo ufw default allow outgoing</strong>: This command sets the default policy for all outgoing connections to allow. This generally allows your VM to initiate connections to the outside world (e.g., for software updates, accessing external services), which is usually necessary.</li> </ul> <h3 id="step-3-allow-specific-ip-addresses-and-ports"> <a href="#step-3-allow-specific-ip-addresses-and-ports" class="anchor-heading" aria-labelledby="step-3-allow-specific-ip-addresses-and-ports"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Step 3: Allow Specific IP Addresses and Ports </h3> <p>Now, we will define rules to allow incoming traffic from specific IP addresses on specific ports. The general syntax for allowing traffic from a specific IP to a specific port using UFW is:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>ufw allow from &lt;ALLOWED_IP&gt; to any port &lt;PORT&gt; <span class="o">[</span>proto &lt;PROTOCOL&gt;] <span class="o">[</span>comment <span class="s2">"&lt;DESCRIPTION&gt;"</span><span class="o">]</span>
</code></pre></div></div> <ul> <li><strong>&lt;ALLOWED_IP&gt;</strong>: Replace this with the IP address you want to allow. This can be a single IP address (e.g., 203.0.113.5) or an IP range in CIDR notation (e.g., 192.168.1.0/24).</li> <li><strong>&lt;PORT&gt;</strong>: Replace this with the port number you want to open (e.g., 22, 80, 443, 3306).</li> <li><strong>[proto &lt;PROTOCOL&gt;]</strong>: Optionally specify the protocol, usually tcp or udp. If omitted, UFW usually defaults to tcp for common ports but it’s best to be explicit when needed (e.g., for UDP based services).</li> <li><strong>[comment “&lt;DESCRIPTION&gt;”]</strong>: Adding a comment helps you remember why a rule was created. This is highly recommended for maintainability.</li> </ul> <h3 id="some-common-examples-of-allow-rules"> <a href="#some-common-examples-of-allow-rules" class="anchor-heading" aria-labelledby="some-common-examples-of-allow-rules"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Some Common Examples of Allow Rules: </h3> <ol> <li>Allow SSH (port 22) access from a single IP address 203.0.113.5 <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>ufw allow from 203.0.113.5 to any port 22 proto tcp comment <span class="s2">"Allow SSH from home IP"</span>
</code></pre></div> </div> </li> <li>Allow HTTP (port 80) and HTTPS (port 443) access from a specific IP address 203.0.113.5 <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>ufw allow from 203.0.113.5 to any port 80 proto tcp comment <span class="s2">"Allow HTTP from home IP"</span>
<span class="nb">sudo </span>ufw allow from 203.0.113.5 to any port 443 proto tcp comment <span class="s2">"Allow HTTPS from home IP"</span>
</code></pre></div> </div> </li> <li>Allow SSH (port 22) access from a range of IP addresses 198.51.100.0/24 (e.g., your office network) <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>ufw allow from 198.51.100.0/24 to any port 22 proto tcp comment <span class="s2">"Allow SSH from office network"</span>
</code></pre></div> </div> </li> <li>Allow MySQL/MariaDB (port 3306) access from IP 192.0.2.10 <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>ufw allow from 192.0.2.10 to any port 3306 proto tcp comment <span class="s2">"Allow MySQL from DB admin server"</span>
</code></pre></div> </div> </li> <li>Allow UDP port 53 (DNS) from a specific IP (though typically DNS queries are outgoing, this is just an example of UDP) <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>ufw allow from 203.0.113.5 to any port 53 proto udp comment <span class="s2">"Allow UDP DNS from home IP (example)"</span>
</code></pre></div> </div> <blockquote> <p>Repeat Step 3 for every IP address and port combination that needs to be allowed access to your VM.</p> </blockquote> </li> </ol> <h3 id="step-4-enable-ufw"> <a href="#step-4-enable-ufw" class="anchor-heading" aria-labelledby="step-4-enable-ufw"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Step 4: Enable UFW </h3> <p><strong>Crucial Precaution</strong>: Before enabling UFW, ensure you have created a rule to allow SSH access from your current IP address. If you are accessing your VM via SSH and you enable UFW without allowing your current IP on port 22 (or your custom SSH port), you will likely lose your SSH connection and be locked out.</p> <p><strong>If you are unsure, as a safety measure, you can temporarily allow SSH from anywhere before enabling UFW, and then refine the rule afterward:</strong></p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>ufw allow ssh comment <span class="s2">"Temporary allow SSH from anywhere for initial setup"</span>
</code></pre></div></div> <p><strong>After verifying your SSH access is working, you can then enable UFW:</strong></p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>ufw <span class="nb">enable</span>
</code></pre></div></div> <p>You will be prompted to confirm enabling the firewall. Type y and press Enter.</p> <blockquote> <p>Once UFW is enabled, it will start enforcing the rules you have defined, including the default deny incoming policy.</p> </blockquote> <p><strong>If you temporarily allowed SSH from anywhere, now you should replace that rule with a more specific rule to allow SSH only from your known IP(s) and delete the broad “allow ssh” rule.</strong></p> <p>For example, to allow SSH only from 203.0.113.5 and remove the temporary rule:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>ufw allow from 203.0.113.5 to any port 22 proto tcp comment <span class="s2">"Allow SSH from home IP"</span>
<span class="nb">sudo </span>ufw delete allow ssh  <span class="c"># Deletes the rule that allows SSH from anywhere (if you added it)</span>
</code></pre></div></div> <h3 id="step-5-verify-ufw-rules-and-status"> <a href="#step-5-verify-ufw-rules-and-status" class="anchor-heading" aria-labelledby="step-5-verify-ufw-rules-and-status"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Step 5: Verify UFW Rules and Status </h3> <p>To check the current status of UFW and review the configured rules, use the command:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>ufw status numbered
</code></pre></div></div> <p>This command will display the status of UFW (active or inactive) and list all the active rules with numbers assigned to each rule. This numbered list is helpful if you need to delete a specific rule later.</p> <p><strong>Example Output:</strong></p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Status: active

     To                         Action      From
     ----                       ------      ----
[ 1] 22/tcp                     ALLOW IN    203.0.113.5
[ 2] 80/tcp                     ALLOW IN    203.0.113.5
[ 3] 443/tcp                    ALLOW IN    203.0.113.5
[ 4] 22/tcp                     ALLOW IN    198.51.100.0/24
</code></pre></div></div> <p>This output shows that UFW is active and the following rules are in place:</p> <ul> <li>Rule 1: Allows TCP traffic on port 22 (SSH) from IP address 203.0.113.5</li> <li>Rule 2: Allows TCP traffic on port 80 (HTTP) from IP address 203.0.113.5</li> <li>Rule 3: Allows TCP traffic on port 443 (HTTPS) from IP address 203.0.113.5</li> <li>Rule 4: Allows TCP traffic on port 22 (SSH) from the IP range 198.51.100.0/24</li> </ul> <h3 id="real-case---firewall-configuration-scenario"> <a href="#real-case---firewall-configuration-scenario" class="anchor-heading" aria-labelledby="real-case---firewall-configuration-scenario"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Real Case - Firewall Configuration Scenario </h3> <p>Let’s say you want to configure your VM with the following requirements:</p> <ul> <li>Allow SSH access only from IP addresses 203.0.113.5 and 198.51.100.10</li> <li>Allow HTTP (port 80) and HTTPS (port 443) access only from IP address 203.0.113.5</li> <li>Block all other incoming traffic</li> </ul> <p><strong>Here are the set of ubuntu commands you would execute:</strong></p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>apt update <span class="o">&amp;&amp;</span> <span class="nb">sudo </span>apt <span class="nb">install </span>ufw  <span class="c"># Step 1 (if needed)</span>
<span class="nb">sudo </span>ufw default deny incoming          <span class="c"># Step 2</span>
<span class="nb">sudo </span>ufw default allow outgoing         <span class="c"># Step 2</span>

<span class="c">#sudo ufw allow from 203.0.113.5 to any port 22</span>
<span class="c">#sudo ufw allow from 203.0.113.5 to any port 80</span>
<span class="c">#sudo ufw allow from 203.0.113.5 to any port 443</span>
<span class="c">#sudo ufw allow from 198.51.100.10 to any port 22</span>

<span class="nb">sudo </span>ufw allow from 203.0.113.5 to any port 22 proto tcp comment <span class="s2">"Allow SSH from home IP"</span> <span class="c"># Step 3</span>
<span class="nb">sudo </span>ufw allow from 198.51.100.10 to any port 22 proto tcp comment <span class="s2">"Allow SSH from secondary IP"</span> <span class="c"># Step 3</span>
<span class="nb">sudo </span>ufw allow from 203.0.113.5 to any port 80 proto tcp comment <span class="s2">"Allow HTTP from home IP"</span> <span class="c"># Step 3</span>
<span class="nb">sudo </span>ufw allow from 203.0.113.5 to any port 443 proto tcp comment <span class="s2">"Allow HTTPS from home IP"</span> <span class="c"># Step 3</span>

<span class="nb">sudo </span>ufw <span class="nb">enable</span>                       <span class="c"># Step 4</span>
<span class="nb">sudo </span>ufw status numbered              <span class="c"># Step 5 (Verify)</span>
</code></pre></div></div> <h3 id="important-notes-and-best-practices"> <a href="#important-notes-and-best-practices" class="anchor-heading" aria-labelledby="important-notes-and-best-practices"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Important Notes and Best Practices: </h3> <ul> <li><strong>Lockout Prevention is Paramount</strong>: Always be extremely cautious when enabling and configuring firewalls. Ensure you have a way to access your VM even if you misconfigure the firewall (e.g., through a cloud provider’s console access). Test your rules incrementally. Add one rule at a time and verify connectivity before adding more.</li> <li><strong>IP Ranges (CIDR Notation)</strong>: Use CIDR notation (e.g., 192.168.1.0/24) when you need to allow access from a range of IP addresses, such as a network.</li> <li><strong>Deleting Rules</strong>: If you need to remove a rule, use the sudo ufw delete <RULE_NUMBER> command. You can get the rule number from the output of sudo ufw status numbered. For example, to delete rule number 1, use: sudo ufw delete 1. You can also delete rules by specifying the rule itself, e.g., sudo ufw delete allow from 203.0.113.5 to any port 22 proto tcp.</RULE_NUMBER></li> <li><strong>Rule Order</strong>: UFW rules are generally processed in order. The first rule that matches the incoming traffic will be applied. While UFW tries to optimize rule order, it’s generally a good practice to place more specific rules before broader ones.</li> <li><strong>Testing Your Configuration</strong>: After enabling UFW and setting up your rules, thoroughly test your setup. Try accessing your VM from the allowed IP addresses on the allowed ports. Also, try to access it from a disallowed IP address or on a disallowed port to confirm that the firewall is blocking as expected.</li> <li><strong>Comments are as Your Friends</strong>: Always use comments (comment “<DESCRIPTION>") when adding rules. This makes it much easier to understand and manage your firewall rules in the future.</DESCRIPTION></li> <li><strong>Persistence</strong>: UFW rules are persistent by default. They will be automatically loaded when your VM reboots. You don’t need to take extra steps to save them.</li> <li><strong>Advanced Scenarios (Optional)</strong>: For very large sets of IP addresses, consider using ipset with iptables directly, as mentioned in the more advanced section below. However, for most common use cases, UFW is sufficient and easier to manage.</li> </ul> <h3 id="advanced-topic-using-ipset-for-very-large-ip-sets-optional"> <a href="#advanced-topic-using-ipset-for-very-large-ip-sets-optional" class="anchor-heading" aria-labelledby="advanced-topic-using-ipset-for-very-large-ip-sets-optional"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Advanced Topic: Using ‘ipset’ for Very Large IP Sets (Optional) </h3> <p>If you need to manage firewall rules for a very large number of IP addresses (thousands or more), using ipset directly with iptables can be more efficient than adding individual UFW/iptables rules. ipset allows you to create named sets of IPs and then match against these sets in your iptables rules.</p> <blockquote> <p>Note: Using ipset directly requires a deeper understanding of iptables and is generally only necessary for very specific, high-scale scenarios. For most users, UFW is sufficient.</p> </blockquote> <p>If you choose to explore ipset, you would follow steps similar to these (this is a brief overview and not a complete tutorial):</p> <ol> <li>Install ipset: sudo apt install ipset</li> <li>Create an ipset: sudo ipset create ALLOWED_IPS hash:ip (creates a set named ALLOWED_IPS of type hash:ip).</li> <li>Add IPs to the set: sudo ipset add ALLOWED_IPS 203.0.113.5, sudo ipset add ALLOWED_IPS 198.51.100.10, etc.</li> <li>Create iptables rules that use the ipset:</li> </ol> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>iptables <span class="nt">-A</span> INPUT <span class="nt">-m</span> <span class="nb">set</span> <span class="nt">--match-set</span> ALLOWED_IPS src <span class="nt">-p</span> tcp <span class="nt">--dport</span> 22 <span class="nt">-j</span> ACCEPT
<span class="nb">sudo </span>iptables <span class="nt">-A</span> INPUT <span class="nt">-m</span> <span class="nb">set</span> <span class="nt">--match-set</span> ALLOWED_IPS src <span class="nt">-p</span> tcp <span class="nt">--dport</span> 80 <span class="nt">-j</span> ACCEPT
<span class="nb">sudo </span>iptables <span class="nt">-A</span> INPUT <span class="nt">-m</span> <span class="nb">set</span> <span class="nt">--match-set</span> ALLOWED_IPS src <span class="nt">-p</span> tcp <span class="nt">--dport</span> 443 <span class="nt">-j</span> ACCEPT
<span class="nb">sudo </span>iptables <span class="nt">-A</span> INPUT <span class="nt">-j</span> DROP  <span class="c"># Default drop rule (similar to UFW's default deny incoming)</span>
</code></pre></div></div> <ol> <li>Make iptables rules persistent (using iptables-persistent package if needed).</li> </ol> <h3 id="alternative-using-iptables-directly-advanced-users"> <a href="#alternative-using-iptables-directly-advanced-users" class="anchor-heading" aria-labelledby="alternative-using-iptables-directly-advanced-users"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Alternative: Using ‘iptables’ Directly (Advanced Users) </h3> <p>While UFW simplifies firewall management, you can also configure iptables directly for more granular control. However, this method is more complex and error-prone for beginners. If you are comfortable with iptables, you can achieve the same results by directly manipulating iptables rules, setting <strong>default policies</strong>, and creating ACCEPT rules for specific source IPs and destination ports. Remember to save your iptables rules to persist after a reboot if you use iptables directly.</p> <h3 id="conclusion"> <a href="#conclusion" class="anchor-heading" aria-labelledby="conclusion"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Conclusion </h3> <p>By following this guide, you have successfully configured your Cloud GPU VM firewalls &amp; Security Groups to allow incoming traffic only from specific IP addresses and on designated ports using UFW. This significantly enhances the security of your VM by limiting exposure to unauthorized access attempts. Remember to always test your firewall rules and maintain a record of your configuration for future management. Always prioritize security best practices and keep your system updated.</p> </main> </div> </div> <div class="search-overlay"></div> </div> </body> </html>
